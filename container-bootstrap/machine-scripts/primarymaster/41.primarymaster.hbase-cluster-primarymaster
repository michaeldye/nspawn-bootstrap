#!/bin/bash -e

SOURCE=$(realpath $(dirname $0))

source $SOURCE/scripts-include-pkg

HOST=$1; shift
DOMAIN=$1; shift

echo "Executing setup of HBase Primary Master on $HOST.$DOMAIN"

source ~admin/.bash_profile

svc=hbase-primarymaster.service

cp $SOURCE/fs/etc/systemd/system/$svc /etc/systemd/system/

if [ ! -e "/etc/systemd/system/multi-user.target.wants/$svc" ]; then
  ln -s /etc/systemd/system/$svc /etc/systemd/system/multi-user.target.wants/
fi

cp $SOURCE/fs/usr/hbase/conf/* /usr/hbase/conf/
cp $SOURCE/fs/etc/security/limits.conf /etc/security/

echo "session required pam_limits.so" >> /etc/pam.d/common-session

exit 0
